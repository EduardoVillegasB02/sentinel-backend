generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Rol {
  administrator
  supervisor
  sentinel
}

model Bodycam {
  id                    String                @id @default(uuid())
  name                  String
  serie                 String
  reports               Report[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Evidence {
  id                    String                @id @default(uuid())
  description           String
  path                  String
  mimetype              String
  size                  Int
  report                Report                @relation(fields: [report_id], references: [id])
  report_id             String
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Job {
  id                    String                @id @default(uuid())
  name                  String                @unique()
  leads                 Lead[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Lack {
  id                    String                @id @default(uuid())
  article               String?
  content               String
  description           String?
  name                  String
  subject_id            String
  subject               Subject               @relation(fields: [subject_id], references: [id])
  reports               Report[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Lead {
  id                    String                @id @default(uuid())
  name                  String
  lastname              String
  job                   Job                   @relation(fields: [job_id], references: [id])
  job_id                String
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Offender {
  id                    String                @id @default(uuid())
  name                  String
  lastname              String
  dni                   String                @unique()
  gestionate_id         Int
  subgerencia           String
  job                   String
  regime                String
  shift                 String
  reports               Report[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Report {
  id                    String                @id @default(uuid())
  address               String
  date                  DateTime
  bodycam_user          String
  bodycam_supervisor    String
  header                Json
  latitude              Float
  longitude             Float
  message               String?
  bodycam               Bodycam               @relation(fields: [bodycam_id], references: [id])
  bodycam_id            String
  lack                  Lack                  @relation(fields: [lack_id], references: [id])
  lack_id               String
  offender              Offender              @relation(fields: [offender_id], references: [id])
  offender_id           String
  subject               Subject               @relation(fields: [subject_id], references: [id])
  subject_id            String
  user                  User                  @relation(fields: [user_id], references: [id])
  user_id               String
  evidences             Evidence[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model Subject {
  id                    String                @id @default(uuid())
  name                  String
  lacks                 Lack[]
  reports               Report[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}

model User {
  id                    String                @id @default(uuid())
  username              String                @unique
  password              String
  name                  String
  lastname              String
  email                 String                @unique
  dni                   String?               @unique
  phone                 String?               @unique
  token                 String?
  rol                   Rol
  reports               Report[]
  created_at            DateTime              @default(now())
  updated_at            DateTime              @updatedAt
  deleted_at            DateTime?
}
